<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>GOPAY AFRICA - Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css">

<style>
body{margin:0;font-family:Roboto;background:#fff8f0;color:#011a27;scroll-behavior:smooth;}
header{position:fixed;top:0;left:0;width:100%;background:#ff6f00;display:flex;justify-content:space-between;align-items:center;padding:12px 20px;box-shadow:0 2px 12px rgba(0,0,0,0.2);z-index:100;}
.logo{font-size:24px;font-weight:700;color:#fff;padding:6px 12px;border-radius:8px;background:#ff9100;}
.menu{display:flex;gap:12px;flex-wrap:wrap;}
.menu a{text-decoration:none;color:#fff;font-weight:600;padding:6px 12px;border-radius:8px;transition:0.3s;}
.menu a:hover{background:#fff;color:#ff6f00;}
section{padding:100px 20px 60px;margin-top:60px;border-radius:12px;}
.hero{background:url('https://images.unsplash.com/photo-1581091870626-5d3b7ff60937?crop=entropy&cs=tinysrgb&fit=max&fm=jpg') center/cover no-repeat;color:#fff;text-align:center;padding:180px 20px;border-radius:12px;box-shadow:inset 0 0 0 1000px rgba(0,0,0,0.2);}
.hero h1{font-size:48px;margin-bottom:20px;text-shadow:2px 2px 10px rgba(0,0,0,0.6);}
.hero p{font-size:20px;margin-bottom:30px;text-shadow:1px 1px 6px rgba(0,0,0,0.5);}
.btn-cta{background:#ff9100;color:#fff;padding:14px 28px;border:none;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;transition:0.3s;}
.btn-cta:hover{background:#ff6f00;}
.card-section{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-top:40px;}
.card{background:#fff3e0;padding:20px;border-radius:16px;box-shadow:0 4px 25px rgba(0,0,0,0.12);text-align:center;transition:0.3s;}
.card:hover{transform:translateY(-8px);box-shadow:0 8px 30px rgba(0,0,0,0.2);}
.card i{font-size:36px;color:#ff9100;margin-bottom:10px;}
.card h3{margin:10px 0;}
.card p{font-size:14px;opacity:0.9;}
.card img{width:100%;border-radius:12px;margin-top:10px;transition:transform 0.3s;}
.card img:hover{transform:scale(1.05);}
footer{background:#ff6f00;color:#fff;padding:40px 20px;text-align:center;}
footer a{color:#fff;text-decoration:none;}
footer a:hover{text-decoration:underline;}
.panel{background:#fff;padding:20px;border-radius:16px;margin:20px 0;box-shadow:0 4px 20px rgba(0,0,0,0.08);}
.hidden{display:none;}
.actions{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;margin-top:20px;}
.action{background:#ff9100;color:#fff;padding:12px;border-radius:12px;text-align:center;font-weight:700;cursor:pointer;transition:0.3s;}
.action:hover{background:#ff6f00;transform:translateY(-2px);}
.card-dashboard{background:#fff3e0;padding:20px;border-radius:16px;box-shadow:0 4px 25px rgba(0,0,0,0.12);text-align:center;margin-bottom:20px;}
canvas{background:#fff;border-radius:12px;}
input, select{width:100%;padding:10px;margin-bottom:12px;border-radius:8px;border:1px solid #ccc;}

/* Nouveau bouton Retour */
.btn-back{background:#011a27;color:#fff;padding:10px 16px;border-radius:12px;font-weight:700;cursor:pointer;transition:0.3s;margin-bottom:12px;}
.btn-back:hover{background:#333;}
</style>
</head>
<body>

<header>
<div class="logo">GOPAY AFRICA</div>
<nav class="menu">
<a href="#home">Accueil</a>
<a href="#why">Pourquoi nous rejoindre</a>
<a href="#success">Nos succès</a>
<a href="#values">Nos valeurs</a>
<a href="#mission">Mission & Stats</a>
<a href="#partners">Partenaires</a>
<a onclick="scrollToContact()">Nous contacter</a>
<a onclick="show('login')">Se connecter</a>
</nav>
</header>

<!-- ===== PAGE D'ACCUEIL ===== -->
<section id="home" class="hero">
<h1>Votre Néobanque Africaine</h1>
<p>Transactions rapides, sécurisées et multi-devises pour tous</p>
<button class="btn-cta" onclick="show('login')">Se connecter</button>
</section>

<!-- ===== POURQUOI NOUS REJOINDRE ===== -->
<section id="why">
<h2 style="text-align:center;">Pourquoi nous rejoindre <i class='bx bx-badge-check'></i></h2>
<div class="card-section">
<div class="card"><i class='bx bx-rocket'></i><h3>Innovation</h3><p>Services financiers digitaux et modernes.</p></div>
<div class="card"><i class='bx bx-shield'></i><h3>Sécurité</h3><p>Protection maximale des transactions.</p></div>
<div class="card"><i class='bx bx-group'></i><h3>Support</h3><p>Support dédié 24/7.</p></div>
</div>
</section>

<!-- ===== LOGIN / REGISTER ===== -->
<div id="login" class="panel hidden">
<h3>Connexion</h3>
<input id="lEmail" placeholder="Email"><br>
<input id="lPass" type="password" placeholder="Mot de passe"><br>
<div class="actions">
<div class="action" onclick="login()">Connexion</div>
<div class="action" onclick="show('register')">Créer compte</div>
</div>
</div>

<div id="register" class="panel hidden">
<h3>Créer compte</h3>
<input id="rName" placeholder="Nom"><br>
<input id="rEmail" placeholder="Email"><br>
<input id="rPass" type="password" placeholder="Mot de passe"><br>
<select id="rRole">
<option value="client">Client</option>
<option value="agent">Agent</option>
<option value="admin">Admin</option>
</select>
<div class="actions">
<div class="action" onclick="register()">Créer</div>
<div class="btn-back" onclick="show('login')">Retour</div>
</div>
</div>

<!-- ===== DASHBOARD CLIENT ===== -->
<div id="dash" class="panel hidden">
<div class="btn-back" onclick="show('home')">Retour au menu</div>
<h3>Dashboard Utilisateur</h3>
<div class="card-dashboard">
<h3 id="cardName"></h3>
<p>ID: <span id="cardId"></span></p>
<p>Solde: $<span id="balance"></span></p>
<canvas id="qr"></canvas>
</div>
<div class="actions">
<div class="action" onclick="cashin()">Cash-in</div>
<div class="action" onclick="cashout()">Cash-out</div>
<div class="action" onclick="pay()">Paiement</div>
<div class="action" onclick="logout()">Déconnexion</div>
</div>
<h4>Activités Récentes</h4>
<div id="history"></div>
</div>

<!-- ===== ADMIN ===== -->
<div id="admin" class="panel hidden">
<div class="btn-back" onclick="show('dash')">Retour</div>
<h3>Admin Dashboard</h3>
<p>Total Clients: <span id="totalClients">0</span></p>
<p>Total Agents: <span id="totalAgents">0</span></p>
<p>Total Transactions: <span id="totalTransactions">0</span></p>
<canvas id="adminChart" width="400" height="200"></canvas>
<table id="usersTable"></table>
</div>

<footer>
<h4>© 2026 GoPay Africa Digital Finance Ltd</h4>
</footer>

<script>
// ===== FIREBASE INITIALIZATION =====
firebase.initializeApp({
apiKey:"AIzaSyA-p_WgDeRhaGsP0zJYmd9aIw7GwuC6k6g",
authDomain:"gotrustpay-e6524.firebaseapp.com",
projectId:"gotrustpay-e6524",
});
const auth=firebase.auth();
const db=firebase.firestore();
let currentUser=null;

// ===== NAVIGATION =====
function show(id){document.querySelectorAll(".panel").forEach(p=>p.classList.add("hidden"));document.getElementById(id).classList.remove("hidden");}
function scrollToContact(){document.getElementById('contact').scrollIntoView({behavior:'smooth'});}

// ===== REGISTER / LOGIN =====
async function register(){
try{
const cred=await auth.createUserWithEmailAndPassword(rEmail.value,rPass.value);
let gid="GP"+Math.random().toString(36).substring(2,7).toUpperCase();
await db.collection("users").doc(cred.user.uid).set({name:rName.value,email:rEmail.value,role:rRole.value,gid,balance:50,sessionToken:null,totalCommission:0});
alert("Compte créé avec succès");
show('login');
}catch(e){alert(e.message);}
}

async function login(){
try{
const cred=await auth.signInWithEmailAndPassword(lEmail.value,lPass.value);
const snap=await db.collection("users").doc(cred.user.uid).get();
currentUser=snap.data();
if(currentUser.sessionToken && currentUser.sessionToken!==cred.user.uid){alert("Session active ailleurs");logout();return;}
await db.collection("users").doc(cred.user.uid).update({sessionToken:cred.user.uid});
loadDashboard();
}catch(e){alert(e.message);}
}

function logout(){
auth.signOut();
currentUser=null;
show('home');
}

// ===== DASHBOARD =====
async function loadDashboard(){
cardName.innerText=currentUser.name;
cardId.innerText=currentUser.gid;
balance.innerText=currentUser.balance.toFixed(2);
QRCode.toCanvas(qr,currentUser.gid);
loadFakeHistory();
if(currentUser.role==='admin'){setTimeout(()=>openAdmin(),500);}
show('dash');
}

function loadFakeHistory(){
const names=["Ali","John","Fatou","David","Eric","Nadine","Prince"];
history.innerHTML="";
for(let i=0;i<6;i++){
let n=names[Math.floor(Math.random()*names.length)];
let amt=(Math.random()*200).toFixed(2);
history.innerHTML+=`<p>${n} a transféré $${amt}</p>`;
}

// CASHIN / CASHOUT / PAY
async function cashin(){let amt=parseFloat(prompt("Montant"));if(!amt)return;await db.collection("users").doc(auth.currentUser.uid).update({balance:firebase.firestore.FieldValue.increment(amt)});currentUser.balance+=amt;loadDashboard();}
async function cashout(){let amt=parseFloat(prompt("Montant"));if(!amt)return;await db.collection("users").doc(auth.currentUser.uid).update({balance:firebase.firestore.FieldValue.increment(-amt)});currentUser.balance-=amt;loadDashboard();}
async function pay(){let amt=parseFloat(prompt("Montant"));let dest=prompt("ID destinataire");let snap=await db.collection("users").where("gid","==",dest).get();if(snap.empty){alert("Utilisateur introuvable");return;}let doc=snap.docs[0];await db.collection("users").doc(auth.currentUser.uid).update({balance:firebase.firestore.FieldValue.increment(-amt)});await db.collection("users").doc(doc.id).update({balance:firebase.firestore.FieldValue.increment(amt)});currentUser.balance-=amt;loadDashboard();}

// ADMIN
async function openAdmin(){
show('admin');
let users=await db.collection("users").get();
totalClients.innerText=users.docs.filter(u=>u.data().role==='client').length;
totalAgents.innerText=users.docs.filter(u=>u.data().role==='agent').length;
totalTransactions.innerText=await db.collection('transactions').get().then(s=>s.size);
usersTable.innerHTML="<tr><th>Nom</th><th>Email</th><th>Role</th><th>Solde</th></tr>";
users.docs.forEach(doc=>{let u=doc.data();usersTable.innerHTML+=`<tr><td>${u.name}</td><td>${u.email}</td><td>${u.role}</td><td>$${u.balance.toFixed(2)}</td></tr>`;});
}

// CHART
const ctx = document.getElementById('txnChart')?.getContext('2d');
if(ctx){new Chart(ctx,{type:'bar',data:{labels:['Jan','Fév','Mar','Avr','Mai','Juin','Juil'],datasets:[{label:'Transactions',data:[5,8,6,10,12,15,20],backgroundColor:'#ff9100'}]},options:{responsive:true}});}
</script>
</body>
</html>
