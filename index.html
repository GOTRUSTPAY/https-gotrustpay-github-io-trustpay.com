<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>GOPAY AFRICA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<style>
body{
margin:0;
font-family:Roboto;
background:#061e1c;
color:white;
overflow-y:auto;
}

header{
background:#012b28;
padding:12px 20px;
display:flex;
justify-content:space-between;
align-items:center;
}

.logo{
font-size:22px;
font-weight:bold;
color:#5eead4;
}

.panel{
background:#043837;
margin:20px;
padding:20px;
border-radius:18px;
}

.hidden{display:none;}

.actions{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
gap:10px;
margin-top:20px;
}

.action{
background:#14b8a6;
padding:12px;
border-radius:12px;
text-align:center;
font-weight:bold;
cursor:pointer;
}

.card{
background:linear-gradient(135deg,#1d4ed8,#0ea5e9);
border-radius:20px;
padding:20px;
box-shadow:0 8px 25px rgba(0,0,0,0.5);
}
</style>
</head>

<body>

<header>
<div class="logo">GOPAY AFRICA</div>
</header>

<!-- HOME -->
<div id="home" class="panel">
<h2>Banque Digitale Africaine</h2>

<h4>FAQ</h4>
<p>Transactions instantanées • KYC sécurisé • Multi-devises</p>

<h4>Confidentialité</h4>
<p>Vos données sont protégées via chiffrement bancaire.</p>

<h4>Contact</h4>
<p>@gopapay.info</p>

<h4>Mentions légales</h4>
<p>GoPay Africa Digital Finance Ltd © 2026</p>

<div class="actions">
<div class="action" onclick="show('login')">Connexion</div>
</div>
</div>

<!-- LOGIN -->
<div id="login" class="panel hidden">

<h3>Connexion</h3>

<input id="lEmail" placeholder="Email"><br><br>
<input id="lPass" type="password" placeholder="Mot de passe"><br><br>

<div class="actions">
<div class="action" onclick="login()">Connexion</div>
<div class="action" onclick="show('register')">Créer compte</div>
</div>

</div>

<!-- REGISTER -->
<div id="register" class="panel hidden">

<h3>Créer Compte</h3>

<input id="rName" placeholder="Nom"><br><br>
<input id="rEmail" placeholder="Email"><br><br>
<input id="rPass" type="password" placeholder="Mot de passe"><br><br>

<select id="rRole" onchange="checkAgent()">
<option value="client">Client</option>
<option value="agent">Agent</option>
</select><br><br>

<input id="agentCode" placeholder="Code Agent" class="hidden"><br><br>

<div class="actions">
<div class="action" onclick="register()">Créer</div>
</div>

</div>

<!-- DASHBOARD -->
<div id="dash" class="panel hidden">

<div class="card">
<h3 id="cardName"></h3>
<p>ID : <span id="cardId"></span></p>
<h2>$ <span id="balance"></span></h2>
<canvas id="qr"></canvas>
</div>

<div class="actions">
<div class="action" onclick="logout()">Déconnexion</div>
</div>

</div>

<!-- ADMIN -->
<div id="admin" class="panel hidden">
<h3>Admin Dashboard</h3>
<p>Total Users : <span id="totalUsers"></span></p>
<table id="usersTable"></table>
</div>

<script>

firebase.initializeApp({
apiKey:"AIzaSyA-p_WgDeRhaGsP0zJYmd9aIw7GwuC6k6g",
authDomain:"gotrustpay-e6524.firebaseapp.com",
projectId:"gotrustpay-e6524",
});

const auth=firebase.auth();
const db=firebase.firestore();

const SECRET_AGENT_CODE="GOPAY2026";

let currentUser=null;

/* NAVIGATION */
function show(id){
document.querySelectorAll(".panel").forEach(p=>p.classList.add("hidden"));
document.getElementById(id).classList.remove("hidden");
}

/* AGENT CODE */
function checkAgent(){
agentCode.classList.toggle("hidden", rRole.value !== "agent");
}

/* REGISTER */
async function register(){

let role=rRole.value;

if(role==="agent"){
if(agentCode.value!==SECRET_AGENT_CODE){
alert("Code agent incorrect");
return;
}
}

const cred=await auth.createUserWithEmailAndPassword(rEmail.value,rPass.value);

const gid="GP"+Math.random().toString(36).substring(2,7).toUpperCase();

await db.collection("users").doc(cred.user.uid).set({
name:rName.value,
email:rEmail.value,
role,
gid,
balance:50
});

loginAuto();
}

/* LOGIN */
async function login(){

const cred=await auth.signInWithEmailAndPassword(lEmail.value,lPass.value);
loadUser(cred.user.uid);

}

/* AUTO LOGIN */
function loginAuto(){
loadUser(auth.currentUser.uid);
}

/* LOAD USER */
async function loadUser(uid){

const snap=await db.collection("users").doc(uid).get();
currentUser=snap.data();

cardName.innerText=currentUser.name;
cardId.innerText=currentUser.gid;
balance.innerText=currentUser.balance.toFixed(2);

QRCode.toCanvas(qr,currentUser.gid);

if(currentUser.role==="admin"){
openAdmin();
}else{
show("dash");
}

}

/* ADMIN PANEL */
async function openAdmin(){

show("admin");

let users=await db.collection("users").get();

totalUsers.innerText=users.size;

usersTable.innerHTML="<tr><th>Nom</th><th>Email</th><th>Role</th></tr>";

users.forEach(doc=>{
let u=doc.data();
usersTable.innerHTML+=`
<tr>
<td>${u.name}</td>
<td>${u.email}</td>
<td>${u.role}</td>
</tr>`;
});

}

/* LOGOUT */
function logout(){
auth.signOut();
show("home");
}

</script>
</body>
</html>
