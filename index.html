<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>GoPay Africa â€“ Secure Fintech</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

<style>
body{margin:0;font-family:Roboto;background:#061e1c;color:#e6fffa}
.hidden{display:none}
header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#012b28}
.logo{font-weight:700;font-size:20px}
.menu-btn{font-size:28px;cursor:pointer}
.menu{position:absolute;top:60px;right:20px;background:#043837;border-radius:12px;display:none}
.menu a{display:block;padding:12px 18px;color:#5eead4;text-decoration:none}
.menu a:hover{background:#065f5b}
main{max-width:1100px;margin:auto;padding:20px}
.panel{background:#043837;padding:20px;border-radius:18px;margin-top:20px}
input,button{width:100%;padding:14px;margin:8px 0;border:none;border-radius:12px}
button{background:#14b8a6;font-weight:700;cursor:pointer}

/* CARD */
.card{
background:linear-gradient(135deg,#0f766e,#022c2a);
border-radius:22px;
padding:25px;
font-family:Orbitron;
box-shadow:0 20px 50px rgba(0,0,0,.6)
}
.card-number{font-size:20px;letter-spacing:3px;margin:15px 0}
.card-row{display:flex;justify-content:space-between;font-size:13px}
.card-balance{font-size:26px;margin-top:10px}

/* ACTIONS */
.actions{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-top:20px}
.action{background:#0d9488;padding:16px;border-radius:14px;text-align:center;font-weight:700;cursor:pointer}
.action:hover{background:#14b8a6}
@media(max-width:600px){.actions{grid-template-columns:repeat(2,1fr)}}

/* TX */
.tx{background:#065f5b;padding:10px;border-radius:10px;margin-top:8px;font-size:14px}

/* ADMIN */
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #065f5b;padding:10px}
th{background:#0d9488}

footer{text-align:center;padding:20px;font-size:14px;opacity:.85}
footer a{color:#5eead4;text-decoration:none;margin:0 6px}
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>

<body>

<header>
<div class="logo">GoPay Africa</div>
<div class="menu-btn" onclick="toggleMenu()">â˜°</div>
</header>

<div class="menu" id="menu">
<a onclick="show('home')">Accueil</a>
<a onclick="show('login')">Connexion</a>
<a onclick="logout()">DÃ©connexion</a>
</div>

<main>

<div id="home" class="panel">
<h2>Paiements digitaux sÃ©curisÃ©s</h2>
</div>

<div id="login" class="panel hidden">
<input id="lEmail" placeholder="Email">
<input id="lPass" type="password" placeholder="Mot de passe">
<button onclick="login()">Se connecter</button>
</div>

<div id="dash" class="hidden">

<div class="card">
<div>VIRTUAL</div>
<div class="card-number">5399 5626 9894 2037</div>
<div class="card-row">
<div>TITULAIRE<br><b id="uName">GOPAY</b></div>
<div>EXP<br><b>12/29</b></div>
</div>
<div class="card-row">
<div>CVV<br><b>947</b></div>
<div>SOLDE</div>
</div>
<div class="card-balance"><span id="uBal">0.00</span> USD</div>
</div>

<div class="actions">
<div class="action" onclick="show('pay')">ðŸ’³ Paiement</div>
<div class="action" onclick="show('cashin')">âž• Cashâ€‘in</div>
<div class="action" onclick="show('cashout')">âž– Cashâ€‘out</div>
<div class="action" onclick="show('history')">ðŸ“œ Historique</div>
</div>

<div class="panel">
<h3>ActivitÃ©s rÃ©centes</h3>
<div id="publicActivities"></div>
</div>
</div>

<div id="pay" class="panel hidden">
<input id="payId" placeholder="ID GoPay destinataire">
<input id="payAmount" type="number" placeholder="Montant USD">
<button onclick="pay()">Confirmer paiement</button>
</div>

<div id="cashin" class="panel hidden">
<input id="cinAmount" type="number" placeholder="Montant USD">
<button onclick="cashin()">Valider Cashâ€‘in</button>
</div>

<div id="cashout" class="panel hidden">
<input id="coutAmount" type="number" placeholder="Montant USD">
<button onclick="cashout()">Valider Cashâ€‘out</button>
</div>

<div id="history" class="panel hidden">
<h3>Historique personnel</h3>
<div id="txs"></div>
</div>

<div id="admin" class="panel hidden">
<h3>ADMIN â€“ Utilisateurs</h3>
<table id="usersTable">
<tr><th>Nom</th><th>RÃ´le</th><th>Solde</th><th>Actif</th></tr>
</table>
<h4>ActivitÃ©s globales</h4>
<div id="adminActivities"></div>
</div>

</main>

<footer>
Â© 2026 GoPay Africa
</footer>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyA-p_WgDeRhaGsP0zJYmd9aIw7GwuC6k6g",
 authDomain:"gotrustpay-e6524.firebaseapp.com",
 projectId:"gotrustpay-e6524"
});
const auth=firebase.auth(),db=firebase.firestore();

function toggleMenu(){menu.style.display=menu.style.display=="block"?"none":"block"}
function show(id){
 document.querySelectorAll("main>div").forEach(x=>x.classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
 menu.style.display="none";
}

function login(){
 auth.signInWithEmailAndPassword(lEmail.value,lPass.value)
 .then(async()=>{
  const uid=auth.currentUser.uid;
  const ref=db.collection("users").doc(uid);
  const snap=await ref.get();
  if(!snap.exists){
    await ref.set({name:"User",balance:50,role:"user",active:true});
  }
  if(auth.currentUser.email==="motivixx.media@gmail.com"){
    await ref.update({role:"admin",active:true});
    show("admin");
    loadUsers();
    loadAdminActivities();
  }else{
    await ref.update({active:true});
    show("dash");
    loadUser();
  }
 })
 .catch(()=>alert("Connexion refusÃ©e"));
}

function logout(){
 if(auth.currentUser)db.collection("users").doc(auth.currentUser.uid).update({active:false});
 auth.signOut();show("home");
}

async function loadUser(){
 const snap=await db.collection("users").doc(auth.currentUser.uid).get();
 uName.textContent=snap.data().name;
 uBal.textContent=(snap.data().balance||0).toFixed(2);
 loadPublicActivities();
 loadTx();
}

async function pay(){
 const id=payId.value;
 const amt=parseFloat(payAmount.value);
 if(!id||amt<=0)return alert("Erreur donnÃ©es");
 const dest=await db.collection("users").where("gid","==",id).get();
 if(dest.empty)return alert("ID invalide");
 const ref=db.collection("users").doc(auth.currentUser.uid);
 const snap=await ref.get();
 if(amt>snap.data().balance)return alert("Solde insuffisant");
 await ref.update({balance:firebase.firestore.FieldValue.increment(-amt)});
 await db.collection("users").doc(dest.docs[0].id)
 .update({balance:firebase.firestore.FieldValue.increment(amt)});
 await db.collection("transactions").add({uid:auth.currentUser.uid,type:"Paiement",amount:-amt,date:new Date()});
 payId.value="";payAmount.value="";
 loadUser();
}

async function cashin(){
 const amt=parseFloat(cinAmount.value);
 if(amt<=0)return alert("Montant invalide");
 await db.collection("users").doc(auth.currentUser.uid)
 .update({balance:firebase.firestore.FieldValue.increment(amt)});
 await db.collection("transactions").add({uid:auth.currentUser.uid,type:"Cashâ€‘in",amount:amt,date:new Date()});
 cinAmount.value="";
 loadUser();
}

async function cashout(){
 const amt=parseFloat(coutAmount.value);
 if(amt<=0)return alert("Montant invalide");
 const destId=prompt("Entrer l'ID GoPay destinataire");
 if(!destId)return;
 const dest=await db.collection("users").where("gid","==",destId).get();
 if(dest.empty)return alert("ID invalide");
 const ref=db.collection("users").doc(auth.currentUser.uid);
 const snap=await ref.get();
 if(amt>snap.data().balance)return alert("Solde insuffisant");
 if(!confirm("Confirmer le retrait de "+amt+" USD ?"))return;
 await ref.update({balance:firebase.firestore.FieldValue.increment(-amt)});
 await db.collection("users").doc(dest.docs[0].id)
 .update({balance:firebase.firestore.FieldValue.increment(amt)});
 await db.collection("transactions").add({uid:auth.currentUser.uid,type:"Cashâ€‘out",amount:-amt,date:new Date()});
 coutAmount.value="";
 loadUser();
}

async function loadTx(){
 txs.innerHTML="";
 const q=await db.collection("transactions")
 .where("uid","==",auth.currentUser.uid)
 .orderBy("date","desc").get();
 q.forEach(d=>{
  const t=d.data();
  txs.innerHTML+=`<div class="tx">${t.type} : ${t.amount} USD</div>`;
 });
}

function loadPublicActivities(){
 const names=["Kevin","Sarah","Amina","Daniel","Linda"];
 const types=["Paiement","Cashâ€‘in","Cashâ€‘out"];
 publicActivities.innerHTML="";
 for(let i=0;i<5;i++){
  publicActivities.innerHTML+=
   `<div class="tx">${names[Math.floor(Math.random()*5)]} â€¢ ${types[Math.floor(Math.random()*3)]} â€¢ ${(Math.random()*500).toFixed(2)} USD</div>`;
 }
}

async function loadUsers(){
 usersTable.innerHTML='<tr><th>Nom</th><th>RÃ´le</th><th>Solde</th><th>Actif</th></tr>';
 const q=await db.collection("users").get();
 q.forEach(d=>{
  const u=d.data();
  usersTable.innerHTML+=`<tr><td>${u.name}</td><td>${u.role}</td><td>${u.balance||0}</td><td>${u.active?"Oui":"Non"}</td></tr>`;
 });
}

function loadAdminActivities(){
 adminActivities.innerHTML="<div class='tx'>Surveillance active</div>";
}
</script>

</body>
</html>
